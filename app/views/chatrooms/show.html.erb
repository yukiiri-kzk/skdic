<h2 class="mt-5">メッセージ</h2>

<div class="row">
  <div class="col-8 offset-2">
    
    <table class="table table-bordered">
      <tbody>
      <tr>
        <th class="text-nowrap">アイテム名</th>
        <td>
          <%= @chatroom.item.name %>
          <div><%= link_to 'このアイテムの詳細を見る', item_path(@chatroom.item) %></div>
        </td>
      </tr>
      <tr>
        <th class="text-nowrap">出品者</th>
        <td><%= link_to @chatroom.exhibitor.name, profile_show_user_path(@chatroom.exhibitor_id) %></td>
      </tr>
      <tr>
        <th class="text-nowrap">受取人</th>
        <td><%= link_to @chatroom.wanter.name, profile_show_user_path(@chatroom.wanter_id) %></td>
      </tr>
      <tr>
        <th class="text-nowrap">カテゴリー</th>
        <td><%= @chatroom.item.category.name %></td>
      </tr>
      <tr>
        <th class="text-nowrap">キャンパス</th>
        <td><%= @chatroom.item.area.name %></td>
      </tr>
      <tr>
        <th class="text-nowrap">アイテム説明</th>
        <td>
          <%= simple_format(@chatroom.item.explanation) %>
        </td>
      </tr>
      </tbody>
    </table>
    
    <div class="d-flex justify-content-center">
      <%= link_to 'このルームを削除する', @chatroom, method: :delete, data: { confirm: '一度削除すると復元できませんが、本当に削除してよろしいですか？' }, class: "mb-5 btn btn-danger rounded-pill" %>
    </div>
    
    <%= form_with(model: @message, local: true) do |f| %>
      <%= f.hidden_field :user_id, value: current_user.id %>
      <%= f.hidden_field :chatroom_id, value: @chatroom.id %>
      <div class="form-group">
        <%= f.text_area :content, class: 'form-control', size: "100x10" %>
      </div>
      
      <div class="mb-5 d-flex justify-content-center">
        <%= f.submit '送信する', class: 'btn btn-primary rounded-pill'%>
      </div>
    <% end %>
  
    <ul style="padding-inline-start: 0px;">
      <% @messages.each do |message| %>
        <li class="media border">
          
          <div>
            <div class="d-flex align-items-center mt-1 ml-1">
              <%  if message.user.image? %>
                <%= image_tag message.user.image.url, class: "rounded-circle", size: "50x50" %>
              <% else%>
                <%= image_tag "default.png", class: "rounded-circle", size: "50x50" %>
              <% end %>
              <%= link_to message.user.name, profile_show_user_path(message.user), class: "mx-1" %> <span class="text-muted">posted at <%= message.created_at %></span>
            </div>
            <div class="media-body">
              <div class="ml-5">
                <p><%= simple_format(message.content) %></p>
              </div>
              <div class="my-2 ml-5">
                <% if current_user == message.user %>
                  <%= link_to "削除", message, method: :delete, data: { confirm: "本当に削除してもよろしいですか?" }, class: 'btn btn-danger btn-sm' %>
                <% end %>
              </div>
            </div>
          </div>
          
          
          
          
        </li>
        
        
      <% end %>
    </ul>
  
  
  </div>
</div>
  