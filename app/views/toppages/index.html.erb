<div class="p-3 mb-4 border">
  <%= form_with url: root_path, method: :get, local: true do |f| %>
    <div class="form-group">
      <%= f.label :name, 'アイテム名' %>
      <%= f.text_field :name, class: 'form-control' %>
    </div>
      
    <div class="form-group">
      <%= f.label :category_id, 'カテゴリー' %>
      <%= f.select :category_id, Category.all.map{ |category| [category.name, category.id]}, { include_blank: true, selected: 0 }, {class: "form-control"} %>
    </div>
      
    <div class="form-group">
      <%= f.label :area_id, '地域' %>
      <%= f.select :area_id, Area.all.map{ |area| [area.name, area.id]}, { include_blank: true, selected: 0 }, {class: "form-control"} %>
    </div>
    
    <div class="d-flex justify-content-center">
      <%= f.submit "検索" %>
    </div>
  <% end %>
</div>

<% @items.each do |item| %>
  <div class="row">
    <div class="col-sm-12 border pl-0 my-2">
      
      <%= image_tag item.image.url, size: "150x150" if item.image? %>
      <div class="col-sm-3 d-inline-block align-top mt-3">
        <p><%= item.name %></p>
        <p><%= item.area.name %></p>
        <%= link_to 'このアイテムの詳細を見る', item_path(item) %>
      </div>
      <div class="col-sm-5 d-inline-block align-top">
        <p><%= simple_format(item.explanation) %></p>
      </div>
      <div class="col-sm-1 d-inline-block">
        <% unless @current_user == item.user.id %>
          <%= form_with model: Chatroom.new, local: true do |f| %>
            <%= f.hidden_field :exhibitor_id, value: item.user.id %>
            <%= f.hidden_field :wanter_id, value: @current_user %>
            <%= f.hidden_field :item_id, value: item.id %>
            <%= f.submit 'ルームを作成する', class: 'btn btn-primary btn-sm rounded-pill'%>
          <% end %>
        <% end %> 
      </div>
    </div>
  </div>
<% end %>

<%= paginate @items %>